syntax = "proto3";
package tutorial;

option csharp_namespace = "Zylance.Contract";

// === Models ===
message FileRef {
  string id = 1;
  string filename = 2;
  bool read_only = 3;
}

message FileFilter {
  string name = 1;
  repeated string extensions = 2;
}

// === File Operation Messages ===
message SelectFileReq {
  optional string title = 1;
  repeated FileFilter filters = 2;
  bool read_only = 3;
}

message CreateFileReq {
  optional string title = 1;
  optional string filename = 2;
  repeated FileFilter filters = 3;
}

message SaveFileReq {
  FileRef file_ref = 1;
  string content = 2;
}

message GetFileReq {
  string path = 1;
}

message FileExistsRes {
  bool exists = 1;
}

message FileContentRes {
  string content = 1;
}

// === Protocol Messages ===
message GatewayEnvelope {
  string message_id = 1;

  oneof payload {
    RequestPayload request = 2;
    ResponsePayload response = 3;
    EventPayload event = 4;
    ErrorPayload error = 5;
  }
}

message RequestPayload {
  string request_id = 1;
  string action = 2;
  optional string data_json = 3;
}

message ResponsePayload {
  string request_id = 1;
  string status = 2;
  optional string data_json = 3;
}

message EventPayload {
  string event = 1;
  optional string data_json = 2;
}

message ErrorPayload {
  optional string request_id = 1;
  string type = 2;
  string details = 3;
}

// === Message ===

message GetStatusRes {
  string status = 1;
}

message EchoReq {
  string message = 1;
}

message EchoRes {
  string echoed = 1;
}